import{r as n,j as e}from"./react-vendor-CmFtR0kx.js";import{a as y,S as me,B as u,R as xe,M as he,I as M,b as m,s as d}from"./vendor-BmnBjY15.js";import"./chart-vendor-N7BNZpo9.js";const pe=()=>{const[w,J]=n.useState([]),[Y,C]=n.useState(!0),[E,b]=n.useState(null),[f,A]=n.useState("all"),[S,H]=n.useState(!1),[ge,K]=n.useState([]),[W,R]=n.useState(!1),[ye,be]=n.useState(null),[fe,je]=n.useState(!1),[l,G]=n.useState("USD"),[q,Q]=n.useState(56.5),[o,x]=n.useState([]),[X,j]=n.useState(!1),[i,v]=n.useState({customer_id:"",customer_name:"",order_date:new Date().toISOString().split("T")[0],total_amount:0,status:"pending",currency:"USD"}),[c,_]=n.useState({name:"",description:"",price:"",category:"FOOD",is_available:!0,currency:"USD"}),[z,D]=n.useState(null),[L,P]=n.useState(null),I=[{value:"FOOD",label:"Food"},{value:"DRINKS",label:"Drinks"},{value:"DESSERT",label:"Dessert"}],k="https://tomlin-backend.onrender.com/api/menu/",Z="https://tomlin-backend.onrender.com/api/orders/";n.useEffect(()=>{F(),T(),ee()},[]);const ee=async()=>{try{Q(56.5)}catch(s){console.error("Error fetching exchange rate:",s)}},F=async()=>{try{C(!0);const s=await y.get(k);J(s.data),C(!1)}catch(s){b("Failed to fetch menu items"),C(!1),console.error("Error fetching menu items:",s)}},T=async()=>{try{const s=await y.get(Z);K(s.data)}catch(s){console.error("Error fetching orders:",s)}},N=(s,t,a)=>t===a?parseFloat(s):t==="USD"&&a==="PHP"?parseFloat(s)*q:t==="PHP"&&a==="USD"?parseFloat(s)/q:parseFloat(s),h=(s,t=l)=>{const r={USD:{currency:"USD",locale:"en-US"},PHP:{currency:"PHP",locale:"en-PH"}}[t];return new Intl.NumberFormat(r.locale,{style:"currency",currency:r.currency}).format(s)},se=()=>{G(s=>s==="USD"?"PHP":"USD"),v(s=>({...s,currency:s.currency==="USD"?"PHP":"USD"}))},te=s=>{const t=o.find(r=>r.id===s.id),a={...s,original_currency:s.currency||"USD",original_price:s.price};x(t?o.map(r=>r.id===s.id?{...r,quantity:r.quantity+1}:r):[...o,{...a,quantity:1}])},$=(s,t)=>{t<1?B(s):x(o.map(a=>a.id===s?{...a,quantity:t}:a))},B=s=>{x(o.filter(t=>t.id!==s))},U=()=>o.reduce((s,t)=>{const a=N(t.original_price,t.original_currency||"USD",l);return s+a*t.quantity},0),O=s=>{const{name:t,value:a}=s.target;v(r=>({...r,[t]:a,total_amount:U()}))},ae=()=>i.customer_id?i.customer_name?o.length===0?(d.error("Your cart is empty"),!1):!0:(d.error("Please provide a customer name"),!1):(d.error("Please provide a customer ID"),!1),re=async()=>{if(ae())try{R(!0);const s={customer_id:i.customer_id,customer_name:i.customer_name,date:i.order_date,status:i.status,currency:l,total_amount:U(),order_items:o.map(t=>({menu_item:t.id,quantity:t.quantity,unit_price:N(t.original_price,t.original_currency||"USD",l),item_currency:l}))};console.log("Sending order data:",JSON.stringify(s,null,2)),await y.post("https://tomlin-backend.onrender.com/api/orders/",s),x([]),j(!1),v({customer_id:"",customer_name:"",order_date:new Date().toISOString().split("T")[0],total_amount:0,status:"pending",currency:l}),d.success("Order placed successfully!"),T()}catch(s){console.error("Error placing order:",s),s.response?(console.error("Error response:",s.response.data),console.error("Status code:",s.response.status),d.error(`Failed to place order: ${JSON.stringify(s.response.data)}`)):d.error("Failed to place order. Please try again.")}finally{R(!1)}},p=s=>{const{name:t,value:a,type:r,checked:g}=s.target;_({...c,[t]:r==="checkbox"?g:a})},ne=s=>{_({...c,currency:s})},le=s=>{const t=s.target.files[0];if(t){D(t);const a=new FileReader;a.onloadend=()=>{P(a.result)},a.readAsDataURL(t)}else D(null),P(null)},ce=async s=>{try{window.confirm("Are you sure you want to delete this item?")&&(await y.delete(`${k}${s}/`),F(),d.success("Menu item deleted successfully!"))}catch(t){b("Failed to delete menu item"),console.error("Error deleting menu item:",t),d.error("Failed to delete menu item")}},oe=async s=>{var t,a;s.preventDefault();try{const r=new FormData;r.append("name",c.name),r.append("description",c.description),r.append("price",c.price),r.append("category",c.category),r.append("is_available",c.is_available),r.append("currency",c.currency),z&&r.append("image",z);const g=await y.post(k,r,{headers:{"Content-Type":"multipart/form-data"}});console.log("API response:",g.data),_({name:"",description:"",price:"",category:"FOOD",is_available:!0,currency:"USD"}),D(null),P(null),H(!1),F(),d.success("Menu item added successfully!")}catch(r){const g=(t=r.response)!=null&&t.data?JSON.stringify(r.response.data):"Failed to add menu item";b(g),console.error("Error adding menu item:",((a=r.response)==null?void 0:a.data)||r),d.error("Failed to add menu item")}},ie=s=>{const t=I.find(a=>a.value===s);return t?t.label:s},de=()=>f==="all"?w:w.filter(s=>s.category===f),V=s=>new Date(s).toLocaleDateString(),ue=s=>{const t=s.currency||"USD",a=N(s.price,t,l);return h(a)};return Y?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"container mx-auto px-4 py-8 h-screen max-h-screen overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:()=>H(!S),className:"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded transition duration-200",children:S?"Cancel":"Add New Item"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:l==="USD"?"font-semibold":"",children:"USD"}),e.jsx(me,{checked:l==="PHP",onChange:se,className:"bg-gray-300"}),e.jsx("span",{className:l==="PHP"?"font-semibold":"",children:"PHP"})]})]}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs(u,{icon:e.jsx(xe,{}),onClick:()=>j(!0),className:"relative",children:["Cart",o.length>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full px-2 py-1",children:o.length})]})}),E&&e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error!"}),e.jsxs("span",{className:"block sm:inline",children:[" ",E]}),e.jsx("button",{className:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:()=>b(null),children:e.jsx("span",{className:"text-xl",children:"Ã—"})})]}),e.jsx(he,{title:`Your Cart (${l})`,open:X,onCancel:()=>j(!1),footer:[e.jsx(u,{onClick:()=>j(!1),children:"Cancel"},"cancel"),e.jsx(u,{type:"primary",onClick:re,loading:W,disabled:o.length===0,children:"Place Order"},"order")],children:o.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"Your cart is empty"}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:o.map(s=>{const t=N(s.original_price,s.original_currency||"USD",l);return e.jsxs("div",{className:"flex justify-between items-center border-b py-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsxs("p",{className:"text-gray-600",children:[h(t)," each",s.original_currency!==l&&e.jsxs("span",{className:"text-xs ml-1 text-gray-500",children:["(original:"," ",h(s.original_price,s.original_currency),")"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{onClick:()=>$(s.id,s.quantity-1),size:"small",children:"-"}),e.jsx("span",{children:s.quantity}),e.jsx(u,{onClick:()=>$(s.id,s.quantity+1),size:"small",children:"+"})]}),e.jsx("div",{className:"mx-4 text-right font-semibold",children:h(t*s.quantity)}),e.jsx(u,{onClick:()=>B(s.id),type:"text",danger:!0,size:"small",children:"Remove"})]},s.id)})}),e.jsxs("div",{className:"text-right font-bold mb-4",children:["Total: ",h(U())]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(M,{placeholder:"Customer ID",name:"customer_id",value:i.customer_id,onChange:O,required:!0}),e.jsx(M,{placeholder:"Customer Name",name:"customer_name",value:i.customer_name,onChange:O,required:!0}),e.jsx(M,{type:"date",name:"order_date",value:i.order_date,onChange:O}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(m,{style:{width:"48%"},value:i.status,onChange:s=>v(t=>({...t,status:s})),children:[e.jsx(m.Option,{value:"pending",children:"Pending"}),e.jsx(m.Option,{value:"completed",children:"Completed"})]}),e.jsxs("div",{className:"text-sm",children:["Currency: ",e.jsx("span",{className:"font-bold",children:l})]})]})]})]})}),S&&e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Add New Menu Item"}),e.jsxs("form",{onSubmit:oe,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"name",children:"Name"}),e.jsx("input",{type:"text",id:"name",name:"name",value:c.name,onChange:p,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"price",children:"Price"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"number",step:"0.01",id:"price",name:"price",value:c.price,onChange:p,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0}),e.jsxs(m,{style:{width:"100px"},value:c.currency,onChange:ne,children:[e.jsx(m.Option,{value:"USD",children:"USD"}),e.jsx(m.Option,{value:"PHP",children:"PHP"})]})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:p,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",rows:"3"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"category",children:"Category"}),e.jsx("select",{id:"category",name:"category",value:c.category,onChange:p,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",children:I.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"image",children:"Image"}),e.jsx("input",{type:"file",id:"image",name:"image",accept:"image/*",onChange:le,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"}),L&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:L,alt:"Preview",className:"w-full h-32 object-cover rounded border"})})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_available",name:"is_available",checked:c.is_available,onChange:p,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-gray-700 text-sm font-bold",htmlFor:"is_available",children:"Is Available"})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{type:"submit",className:"bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded transition duration-200",children:"Add Item"})})]})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>A("all"),className:`px-4 py-2 rounded-md ${f==="all"?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"All"}),I.map(s=>e.jsx("button",{onClick:()=>A(s.value),className:`px-4 py-2 rounded-md ${f===s.value?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:s.label},s.value))]})}),w.length===0?e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-yellow-700",children:'No menu items found. Add your first menu item by clicking the "Add New Item" button.'})})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:de().map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsxs("div",{className:"h-48 bg-gray-300 relative",children:[s.image?e.jsx("img",{src:s.image,alt:s.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"flex items-center justify-center h-full bg-gray-200",children:e.jsx("span",{className:"text-gray-500",children:"No image"})}),!s.is_available&&e.jsx("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded",children:"Not Available"}),e.jsx("div",{className:"absolute top-2 left-2 bg-blue-500 text-white text-xs font-bold px-2 py-1 rounded",children:ie(s.category)}),s.currency&&s.currency!==l&&e.jsxs("div",{className:"absolute bottom-2 right-2 bg-purple-500 text-white text-xs font-bold px-2 py-1 rounded",children:["Originally in ",s.currency]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:s.name}),e.jsx("span",{className:"font-bold text-green-600",children:ue(s)})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-3",children:s.description}),e.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:[e.jsxs("p",{children:["Created: ",V(s.created_at)]}),e.jsxs("p",{children:["Updated: ",V(s.updated_at)]})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[s.is_available&&e.jsxs("button",{onClick:()=>te(s),className:"bg-green-500 hover:bg-green-600 text-white text-sm py-1 px-3 rounded transition duration-200 flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M3 1a1 1 0 000 2h1.22l.305 1.222a.997.997 0 00.01.042l1.358 5.43-.893.892C3.74 11.846 4.632 14 6.414 14H15a1 1 0 000-2H6.414l1-1H14a1 1 0 00.894-.553l3-6A1 1 0 0017 3H6.28l-.31-1.243A1 1 0 005 1H3zM16 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM6.5 18a1.5 1.5 0 100-3 1.5 1.5 0 000 3z"})}),"Add to Cart"]}),e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"flex justify-between items-center py-2 px-4 bg-white border rounded shadow-sm",children:e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:()=>ce(s.id),className:"bg-red-500 hover:bg-red-600 text-white text-sm py-1 px-3 rounded transition duration-200",children:"Delete"})})},s.id)})]})]})]},s.id))})]})},Ce=()=>e.jsx("div",{className:"flex h-screen",children:e.jsx("div",{className:"flex flex-col flex-1",children:e.jsxs("div",{className:"p-6 bg-gray-100",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Menu Management"})}),e.jsx(pe,{})]})})});export{Ce as default};
//# sourceMappingURL=MenuPage-D3ydrWb1.js.map
