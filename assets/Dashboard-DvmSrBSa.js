import{j as e,r as n,w as F,x as E,y as k,n as O,z as P,B as $,C as B}from"./react-vendor-CmFtR0kx.js";import"./chart-vendor-N7BNZpo9.js";import{a as h}from"./vendor-BmnBjY15.js";const U=()=>{const r=new Date().getFullYear();return e.jsx("footer",{className:"bg-gray-100 text-gray-700 text-sm text-center py-4 border-t",children:e.jsx("div",{className:"w-full flex justify-center",children:e.jsxs("div",{className:"w-full md:w-2/3 px-4 space-y-1",children:[e.jsx("p",{className:"font-semibold text-base",children:"Tomlin Eatery"}),e.jsx("p",{children:"Erlinda G. Miguel - Prop"}),e.jsx("p",{children:"Non-VAT Reg Tin: 275-775-517-00000"}),e.jsx("p",{children:"Purok 1, Sumacab Este 3100"}),e.jsx("p",{children:"City of Cabanatuan, Nueva Ecija, Phils."}),e.jsx("hr",{className:"my-2 border-gray-300"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Â© ",r," Dominion AI. All Rights Reserved."]})]})})})},u="https://tomlin-backend.onrender.com",H=()=>{const[r,D]=n.useState({totalRevenue:0,totalOrders:0,totalCustomers:0,totalInventory:0,salesData:[],revenueData:[]}),[o,S]=n.useState({startDate:new Date(new Date().setDate(new Date().getDate()-30)).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[g,p]=n.useState(!0),[c,b]=n.useState(null),[y,z]=n.useState(6e4),[q,G]=n.useState({orders:!1}),[Y,R]=n.useState(0),m=async()=>{try{p(!0);const a=new URLSearchParams({start_date:o.startDate,end_date:o.endDate}).toString(),i=localStorage.getItem("token"),d=i?{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"},s=await h.get(`${u}/api/orders/?${a}`,{headers:d}),x=await h.get(`${u}/api/inventory/`,{headers:d});let f=[];try{f=(await h.get(`${u}/api/orders/?${a}`,{headers:d})).data.revenue_data||[]}catch(t){console.warn("Could not fetch revenue data:",t)}const T=s.data.sales_data||(Array.isArray(s.data)?s.data.map(t=>({date:new Date(t.created_at).toLocaleDateString(),count:1})).reduce((t,l)=>{const w=t.find(_=>_.date===l.date);return w?w.count+=l.count:t.push(l),t},[]):[]),N=s.data.total_revenue||(Array.isArray(s.data)?s.data.reduce((t,l)=>t+(parseFloat(l.amount)||0),0):0),L=Array.isArray(s.data)?[...new Set(s.data.filter(t=>t.customer_name).map(t=>t.customer_name))]:[];D({totalRevenue:N,totalOrders:s.data.total_orders||(Array.isArray(s.data)?s.data.length:0),totalCustomers:L.length,totalInventory:x.data.total_inventory||(Array.isArray(x.data)?x.data.length:0),salesData:T,revenueData:f}),R(N),b(null)}catch(a){console.error("Error fetching dashboard data:",a),b("Failed to load data. Please check your connection and try again.")}finally{p(!1)}};n.useEffect(()=>{m();const a=setInterval(m,y);return()=>clearInterval(a)},[o,y]);const j=a=>{const{name:i,value:d}=a.target;S(s=>({...s,[i]:d}))},C=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),A={labels:r.salesData.map(a=>a.date),datasets:[{label:"Orders",data:r.salesData.map(a=>a.count),backgroundColor:"#3b82f6",borderRadius:6}]},I={labels:r.revenueData.map(a=>a.date),datasets:[{label:"Revenue",data:r.revenueData.map(a=>a.amount),borderColor:"#10b981",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4,fill:!0}]},v={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{intersect:!1,mode:"index"}},scales:{y:{beginAtZero:!0}}};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),e.jsxs("div",{className:"flex space-x-4 items-center",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"date",name:"startDate",value:o.startDate,onChange:j,className:"px-3 py-2 border border-gray-300 rounded-md text-sm"}),e.jsx("span",{className:"self-center",children:"to"}),e.jsx("input",{type:"date",name:"endDate",value:o.endDate,onChange:j,className:"px-3 py-2 border border-gray-300 rounded-md text-sm"})]}),e.jsxs("button",{onClick:m,className:"flex items-center px-4 py-2 bg-indigo-600 text-white rounded-md text-sm hover:bg-indigo-700 transition-colors",children:[e.jsx(F,{className:"mr-2",size:14}),"Refresh"]})]})]})}),e.jsxs("main",{className:"p-6 flex-grow",children:[g&&e.jsx("div",{className:"flex justify-center my-8",children:e.jsx("p",{className:"text-gray-500",children:"Loading dashboard data..."})}),c&&e.jsx("div",{className:"bg-red-50 text-red-600 p-4 rounded-md my-4",children:c}),!g&&!c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-md",children:e.jsx(E,{className:"text-green-600 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Revenue"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:C(r.totalRevenue)})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-md",children:e.jsx(k,{className:"text-blue-600 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Orders"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:r.totalOrders.toLocaleString()})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-md",children:e.jsx(O,{className:"text-purple-600 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Customers"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:r.totalCustomers.toLocaleString()})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-amber-100 rounded-md",children:e.jsx(P,{className:"text-amber-600 text-xl"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Inventory"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:r.totalInventory.toLocaleString()})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Sales Trend"}),e.jsx("div",{className:"h-64",children:e.jsx($,{data:A,options:v})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Revenue Growth"}),e.jsx("div",{className:"h-64",children:e.jsx(B,{data:I,options:v})})]})]})]}),e.jsx(U,{})]})]})};export{H as default};
//# sourceMappingURL=Dashboard-DvmSrBSa.js.map
